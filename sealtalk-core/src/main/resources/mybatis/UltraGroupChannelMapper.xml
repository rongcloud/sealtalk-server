<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.rcloud.server.sealtalk.dao.UltraGroupChannelMapper">
  <resultMap id="BaseResultMap" type="com.rcloud.server.sealtalk.entity.UltraGroupChannel">
    <!--
      WARNING - @mbg.generated
    -->
    <id column="id" jdbcType="INTEGER" property="id" />
    <result column="ultraGroupId" jdbcType="INTEGER" property="ultraGroupId" />
    <result column="channelId" jdbcType="VARCHAR" property="channelId" />
    <result column="channelName" jdbcType="VARCHAR" property="channelName" />
    <result column="type" jdbcType="INTEGER" property="type" />
    <result column="creatorId" jdbcType="INTEGER" property="creatorId" />
    <result column="createdAt" jdbcType="TIMESTAMP" property="createdAt" />
  </resultMap>

  <insert id="insert" parameterType="com.rcloud.server.sealtalk.entity.UltraGroupChannel" useGeneratedKeys="true" keyProperty="id">
    INSERT INTO ultra_group_channel (ultraGroupId, channelId, channelName, type, creatorId, createdAt, updatedAt)
    VALUES (#{ultraGroupId}, #{channelId}, #{channelName}, #{type}, #{creatorId}, now(), now())
  </insert>


  <select id="queryUltraGroupChannelListByPage" resultMap="BaseResultMap">
    SELECT
        c.ultraGroupId,
        c.channelId,
        c.channelName,
        c.type,
        c.creatorId,
        c.createdAt,
        c.updatedAt

    FROM ultra_group_channel c
    where c.ultraGroupId=#{groupId}
    order by c.id
      limit #{limit} offset #{offset}

  </select>

  <!-- 1. 增加一个根据ultraGroupId 查询列表的方法 -->
  <select id="selectByUltraGroupId" resultMap="BaseResultMap">
    SELECT * FROM ultra_group_channel WHERE ultraGroupId = #{ultraGroupId}
  </select>

  <!-- 2. 增加根据ultraGroupId删除的方法 -->
  <delete id="deleteByUltraGroupId">
    DELETE FROM ultra_group_channel WHERE ultraGroupId = #{ultraGroupId}
  </delete>

  <!-- 3. 增加根据ultraGroupId ，channelId 查询单个的方法 -->
  <select id="selectByUltraGroupIdAndChannelId" resultMap="BaseResultMap">
    SELECT * FROM ultra_group_channel WHERE ultraGroupId = #{ultraGroupId} AND channelId = #{channelId}
  </select>

  <!-- 4. 增加根据 ultraGroupId 和 channelId列表删除的方法 -->
  <delete id="deleteByUltraGroupIdAndChannelIds">
    DELETE FROM ultra_group_channel WHERE ultraGroupId = #{ultraGroupId} AND channelId IN
    <foreach collection="channelIds" item="channelId" open="(" separator="," close=")">
      #{channelId}
    </foreach>
  </delete>

  <update id="updateByGroupIdAndChannelIdSelective" parameterType="com.rcloud.server.sealtalk.entity.UltraGroupChannel">
    UPDATE ultra_group_channel
    <set>
      <if test="channelName != null">channelName = #{channelName},</if>
      <if test="type != null">type = #{type},</if>
      updatedAt = now()
    </set>
    WHERE ultraGroupId = #{ultraGroupId} AND channelId = #{channelId}
  </update>
</mapper>